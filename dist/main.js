(()=>{"use strict";function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,o(s.key),s)}}function n(e,n,s){return n&&t(e.prototype,n),s&&t(e,s),Object.defineProperty(e,"prototype",{writable:!1}),e}function s(e,t,n){return(t=o(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(t){var n=function(t,n){if("object"!==e(t)||null===t)return t;var s=t[Symbol.toPrimitive];if(void 0!==s){var o=s.call(t,"string");if("object"!==e(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===e(n)?n:String(n)}const i=n((function e(t,n,o){var i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),s(this,"_openGame",(function(){i._startContainer.classList.add(i._setting.startContainerClassHide),i._gameContainer.classList.add(i._setting.gameContainerClassShow)})),s(this,"closeGame",(function(){i._checkSavedGame(),i._startContainer.classList.remove(i._setting.startContainerClassHide),i._gameContainer.classList.remove(i._setting.gameContainerClassShow)})),s(this,"_checkSavedGame",(function(){return localStorage.getItem("data")||localStorage.getItem("rounds")?(i._btnContinue.classList.remove("button_hide"),!0):(i._btnContinue.classList.add("button_hide"),!1)})),s(this,"setEventListeners",(function(){i._btnTwoPlayers.addEventListener("click",(function(){i._handleResetRound(),i._handleResetGame(),i._openGame()})),i._btnVsRobot.addEventListener("click",(function(){})),i._btnContinue.addEventListener("click",(function(){i._openGame()}))})),this._setting=t,this._startContainer=document.querySelector(this._setting.startContainerSelector),this._gameContainer=document.querySelector(this._setting.gameContainerSelector),this._btnTwoPlayers=document.querySelector(this._setting.btnTwoPlayersSelector),this._btnVsRobot=document.querySelector(this._setting.btnVsRobotSelector),this._btnContinue=document.querySelector(this._setting.btnContinueSelector),this._handleResetRound=n,this._handleResetGame=o}));function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function a(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,u(s.key),s)}}function l(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function c(e,t,n){return(t=u(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u(e){var t=function(e,t){if("object"!==r(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var s=n.call(e,"string");if("object"!==r(s))return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===r(t)?t:String(t)}const _=l((function e(t,n,s,o){var i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),c(this,"_toggleActiveField",(function(){1===i._activePlayer&&(i._iconCross.classList.add(i._setting.itemInactiveClass),i._iconZero.classList.remove(i._setting.itemInactiveClass),i._titlePlayerCross.classList.add(i._setting.playerTitleInactiveClass),i._titlePlayerZero.classList.remove(i._setting.playerTitleInactiveClass)),2===i._activePlayer&&(i._iconCross.classList.remove(i._setting.itemInactiveClass),i._iconZero.classList.add(i._setting.itemInactiveClass),i._titlePlayerCross.classList.remove(i._setting.playerTitleInactiveClass),i._titlePlayerZero.classList.add(i._setting.playerTitleInactiveClass))})),c(this,"_toggleActivePlayer",(function(e){i._activePlayer=e?1===i._lastWinner?2:1:1===i._activePlayer?2:1})),c(this,"_checkWinner",(function(){for(var e=0;e<i._winCombo.length;e++){if(1===i._allSteps[i._winCombo[e][0]]&&1===i._allSteps[i._winCombo[e][1]]&&1===i._allSteps[i._winCombo[e][2]])return!0;if(2===i._allSteps[i._winCombo[e][0]]&&2===i._allSteps[i._winCombo[e][1]]&&2===i._allSteps[i._winCombo[e][2]])return!0}})),c(this,"_setNextRound",(function(){i._lastWinner=i._activePlayer,i._toggleActivePlayer(i._activePlayer),i._handleSetNextRound(i._lastWinner),i._count=0,i._resetRound()})),c(this,"_setItem",(function(e){i._allSteps[e-1]=i._activePlayer,2===i._activePlayer?i._allItems[e-1].classList.add(i._setting.itemCrossClass,i._setting.itemTypeIconClass):i._allItems[e-1].classList.add(i._setting.itemZeroClass,i._setting.itemTypeIconClass),i._count>=8?i._checkWinner()?i._setNextRound():(i._handleSetDraw(),i._toggleActivePlayer(),i._toggleActiveField(),i._count=0,i._resetRound()):i._checkWinner()?i._setNextRound():(i._count++,i._toggleActivePlayer(),i._toggleActiveField()),localStorage.setItem("data",JSON.stringify({steps:i._allSteps,activePlayer:i._activePlayer,count:i._count}))})),c(this,"_setEventListeners",(function(){i._allItems.forEach((function(e){return e.addEventListener("click",(function(){e.classList.contains(i._setting.itemCrossClass)||e.classList.contains(i._setting.itemZeroClass)||i._setItem(+e.getAttribute(i._setting.itemAttr))}))}))})),c(this,"_resetRound",(function(){i._count=0,i._allSteps=i._allSteps.map((function(e){return null})),i._allItems.forEach((function(e){e.classList.remove(i._setting.itemZeroClass,i._setting.itemCrossClass,i._setting.itemTypeIconClass)})),i._toggleActiveField()})),c(this,"restartRound",(function(){i._activePlayer=1,localStorage.removeItem("data"),i._resetRound()})),c(this,"startGameWithPlayer",(function(){if(i._handleInitialRound(i.restartRound),localStorage.getItem("data")){var e=JSON.parse(localStorage.getItem("data")),t=e.steps,n=e.activePlayer,s=e.count;i._allSteps=t,i._activePlayer=n,i._count=s,i._setEventListeners(),i._allSteps.forEach((function(e,t){1===e&&i._allItems[t].classList.add(i._setting.itemTypeIconClass,i._setting.itemZeroClass),2===e&&i._allItems[t].classList.add(i._setting.itemTypeIconClass,i._setting.itemCrossClass)})),i._toggleActiveField()}else i._activePlayer=1,i._setEventListeners(),i._resetRound()})),c(this,"startGameWithRobot",(function(){})),this._setting=t,this._allItems=document.querySelectorAll(this._setting.itemSelector),this._iconZero=document.querySelector(this._setting.iconZeroSelector),this._iconCross=document.querySelector(this._setting.iconCrossSelector),this._titlePlayerZero=document.querySelector(this._setting.playerTitleZeroSelector),this._titlePlayerCross=document.querySelector(this._setting.playerTitleCrossSelector),this._allSteps=this._setting.allSteps,this._activePlayer=1,this._count=0,this._winCombo=this._setting.winCombo,this._handleSetNextRound=n,this._handleSetDraw=s,this._handleInitialRound=o,this._lastWinner=0}));function d(e){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d(e)}function m(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,h(s.key),s)}}function f(e,t,n){return t&&m(e.prototype,t),n&&m(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function y(e,t,n){return(t=h(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function h(e){var t=function(e,t){if("object"!==d(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var s=n.call(e,"string");if("object"!==d(s))return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===d(t)?t:String(t)}const g=f((function e(t,n){var s=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),y(this,"_setWinner",(function(){s._winner&&s._handleStartPause({message:"".concat(1===s._winner?"player # 1":"player # 2"," won!")}),s.resetGame(),s._handleRestartRound()})),y(this,"_checkWinner",(function(){localStorage.setItem("rounds",JSON.stringify(s.rounds));var e=null,t=null;return console.log(e,t,s._activeRound,s._count,s._winner),s.rounds.forEach((function(n){1===n&&e++,2===n&&t++,3===n&&s._count--})),s._activeRound<3&&s._count>0&&(e>s._count&&(s._winner=1),t>s._count&&(s._winner=2)),s._activeRound>1&&s._count<2&&(e>0&&(s._winner=1),t>0&&(s._winner=2)),!1})),y(this,"resetGame",(function(){s._activeRound=0,s.rounds=s.rounds.map((function(e){return null})),s._winner=null,s._count=2,s._roundsElements.forEach((function(e){e.classList.remove("score__round_type_draw",s._setting.roundActiveClass,s._setting.roundZeroClass,s._setting.roundCrossClass)})),localStorage.removeItem("rounds"),s._roundsElements[0].classList.add(s._setting.roundActiveClass)})),y(this,"setDraw",(function(){if(s._activeRound>2)s._handleStartPause({message:"draw! try again!"});else{if(s._roundsElements[s._activeRound].classList.add("score__round_type_draw"),s.rounds[s._activeRound]=3,s._checkWinner(),s._winner)return s._setWinner(),s._winner;s._activeRound++,s._roundsElements[s._activeRound].classList.add(s._setting.roundActiveClass)}})),y(this,"nextRound",(function(e){if(s._round++,1===e&&(s._roundsElements[s._activeRound].classList.add(s._setting.roundZeroClass),s.rounds[s._activeRound]=1),2===e&&(s._roundsElements[s._activeRound].classList.add(s._setting.roundCrossClass),s.rounds[s._activeRound]=2),s._checkWinner(),s._winner)return s._setWinner(),s._winner;s._activeRound++,s._roundsElements[s._activeRound].classList.add(s._setting.roundActiveClass)})),y(this,"setInitialRounds",(function(e){s._handleRestartRound=e,localStorage.getItem("rounds")&&(s.rounds=JSON.parse(localStorage.getItem("rounds")),s.rounds.forEach((function(e,t){e&&(1===e&&s._roundsElements[t].classList.add(s._setting.roundZeroClass),2===e&&s._roundsElements[t].classList.add(s._setting.roundCrossClass),3===e&&s._roundsElements[t].classList.add("score__round_type_draw")),e||0!==s._activeRound||(s._activeRound=t,s._roundsElements[s._activeRound].classList.add(s._setting.roundActiveClass))})))})),this._setting=t,this._roundsElements=document.querySelectorAll(this._setting.roundSelector),this._activeRound=0,this._winner=null,this._textInfo=document.querySelector(this._setting.textInfoSelector),this.rounds=[null,null,null,null],this._handleStartPause=n,this._count=2}));function v(e){return v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},v(e)}function b(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,S(s.key),s)}}function p(e,t,n){return(t=S(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function S(e){var t=function(e,t){if("object"!==v(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var s=n.call(e,"string");if("object"!==v(s))return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===v(t)?t:String(t)}var C=function(){function e(t,n,s,o){var i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),p(this,"setEventListeners",(function(){i._sidemenu.addEventListener("mousedown",(function(e){e.target.classList.contains(i._setting.sidemenuToggleClass)&&i.close()})),i._btnHome.addEventListener("click",(function(){i.close(),i._handleCloseGame()})),i._btnRestart.addEventListener("click",(function(){i._handleResetRound(),i._handleResetGame(),i.close()}))})),p(this,"open",(function(e){i._burger=e,i._burger.classList.add(i._setting.burgerActiveClass),i._sidemenu.classList.add(i._setting.sidemenuToggleClass),i._sidemenuContainer.classList.add(i._setting.sidemenuContainerToggleClass),document.addEventListener("keydown",i._handleEscClose)})),p(this,"close",(function(){i._burger.classList.remove(i._setting.burgerActiveClass),i._sidemenu.classList.remove(i._setting.sidemenuToggleClass),i._sidemenuContainer.classList.remove(i._setting.sidemenuContainerToggleClass),document.removeEventListener("keydown",i._handleEscClose)})),this._setting=t,this._sidemenu=document.querySelector(this._setting.sidemenuSelector),this._sidemenuContainer=document.querySelector(this._setting.sidemenuContainerSelector),this._handleEscClose=this._handleEscClose.bind(this),this._btnHome=document.querySelector(this._setting.btnHometSelector),this._btnRestart=document.querySelector(this._setting.btnRestartSelector),this._handleResetRound=n,this._handleResetGame=s,this._handleCloseGame=o}var t,n;return t=e,(n=[{key:"_handleEscClose",value:function(e){"Escape"===e.key&&this.close()}}])&&b(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();const w=C;function R(e){return R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},R(e)}function P(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,I(s.key),s)}}function L(e,t,n){return t&&P(e.prototype,t),n&&P(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function E(e,t,n){return(t=I(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function I(e){var t=function(e,t){if("object"!==R(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var s=n.call(e,"string");if("object"!==R(s))return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===R(t)?t:String(t)}const T=L((function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),E(this,"_breakPause",(function(){n._pause.classList.remove(n._setting.pauseActiveClass)})),E(this,"startPause",(function(e){var t=e.message;n._pause.classList.add(n._setting.pauseActiveClass),n._pauseInfo.textContent=t})),E(this,"setEventListeners",(function(e,t,s){n._handleRestartRound=e,n._handleResetGame=t,n._handleCloseGame=s,n._pauseBtnHome.addEventListener("click",(function(){n._handleRestartRound(),n._handleResetGame(),n._handleCloseGame(),n._breakPause()})),n._pauseResetHome.addEventListener("click",(function(){n._handleRestartRound(),n._handleResetGame(),n._breakPause()}))})),this._setting=t,this._pause=document.querySelector(this._setting.pauseSelector),this._pauseInfo=this._pause.querySelector(this._setting.pauseInfoSelector),this._pauseBtnHome=this._pause.querySelector(this._setting.btnHomeSelector),this._pauseResetHome=this._pause.querySelector(this._setting.btnResetSelector)}));var k=document.querySelector(".burger"),G=new T({pauseSelector:".pause",pauseActiveClass:"pause_active",pauseInfoSelector:".pause__info",btnHomeSelector:'.button[data-type="home"]',btnResetSelector:'.button[data-type="restart"]'}),A=new g({roundSelector:".score__round",roundActiveClass:"score__round_type_active",roundZeroClass:"score__round_type_zero",roundCrossClass:"score__round_type_cross",textInfoSelector:".game__info"},G.startPause),j=new _({itemSelector:".icon[data-item]",itemAttr:"data-item",iconZeroSelector:'.icon[data-type="zero"]',iconCrossSelector:'.icon[data-type="cross"]',itemZeroClass:"icon_type_zero",itemCrossClass:"icon_type_cross",itemInactiveClass:"icon_type_inactive",itemTypeIconClass:"icon_size_m",playerTitleZeroSelector:'.game__title[data-type="zero"]',playerTitleCrossSelector:'.game__title[data-type="cross"]',playerTitleInactiveClass:"game__title_inactive",allSteps:[null,null,null,null,null,null,null,null,null],winCombo:[[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]]},A.nextRound,A.setDraw,A.setInitialRounds),q=new i({startContainerSelector:".start",startContainerClassHide:"start_hide",gameContainerSelector:".game",gameContainerClassShow:"game_show",btnTwoPlayersSelector:'.button[data-type="btn-two-players"]',btnVsRobotSelector:'.button[data-type="btn-vs-robot"]',btnContinueSelector:'.button[data-type="btn-continue"]'},j.restartRound,A.resetGame),O=new w({burgerActiveClass:"burger_open",sidemenuSelector:".sidemenu",sidemenuToggleClass:"sidemenu_active",sidemenuContainerSelector:".sidemenu__container",sidemenuContainerToggleClass:"sidemenu__container_show",btnHometSelector:'.sidemenu__item[data-type="home"]',btnRestartSelector:'.sidemenu__item[data-type="restart"]'},j.restartRound,A.resetGame,q.closeGame);q.setEventListeners(),O.setEventListeners(),j.startGameWithPlayer(),G.setEventListeners(j.restartRound,A.resetGame,q.closeGame),k.addEventListener("click",(function(){k.classList.contains("burger_open")?O.close():O.open(k)}))})();